# æœƒå“¡ç³»çµ±æ¸¬è©¦æŒ‡å—

## âœ… éšæ®µä¸€å®Œæˆé …ç›®

### å¾Œç«¯ API
- âœ… ä½¿ç”¨è€…è¨»å†Š API (`POST /api/auth/register`)
- âœ… ä½¿ç”¨è€…ç™»å…¥ API (`POST /api/auth/login`)
- âœ… ä½¿ç”¨è€…ç™»å‡º API (`POST /api/auth/logout`)
- âœ… å–å¾—ç•¶å‰ä½¿ç”¨è€… API (`GET /api/auth/me`)
- âœ… JWT èªè­‰æ©Ÿåˆ¶
- âœ… å¯†ç¢¼åŠ å¯† (bcrypt)
- âœ… HTTP-only Cookie å„²å­˜ token

### è³‡æ–™åº«
- âœ… ä½¿ç”¨ Drizzle ORM
- âœ… SQLite è³‡æ–™åº« (`dev.db`)
- âœ… Users è³‡æ–™è¡¨çµæ§‹

### å‰ç«¯é é¢
- âœ… è¨»å†Šé é¢ (`/auth/register`)
- âœ… ç™»å…¥é é¢ (`/auth/login`)
- âœ… æœƒå“¡ä¸­å¿ƒ (`/account`)
- âœ… Auth Store (Pinia)
- âœ… Header çµ„ä»¶æ•´åˆï¼ˆé¡¯ç¤ºä½¿ç”¨è€…è³‡è¨Šï¼‰

---

## ğŸ§ª æ¸¬è©¦æµç¨‹

### 1. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
bun run dev
```

é–‹å•Ÿç€è¦½å™¨è¨ªå• `http://localhost:3000`

### 2. æ¸¬è©¦è¨»å†ŠåŠŸèƒ½

1. é»æ“Š Header çš„ã€Œç™»å…¥ã€æŒ‰éˆ•
2. é»æ“Šã€Œç«‹å³è¨»å†Šã€é€£çµ
3. å¡«å¯«è¨»å†Šè¡¨å–®ï¼š
   - å§“åï¼šæ¸¬è©¦ä½¿ç”¨è€…
   - Emailï¼štest@example.com
   - å¯†ç¢¼ï¼š123456
   - ç¢ºèªå¯†ç¢¼ï¼š123456
   - é›»è©±ï¼ˆå¯é¸ï¼‰ï¼š0912345678
4. é»æ“Šã€Œè¨»å†Šã€æŒ‰éˆ•
5. æ‡‰è©²æœƒè‡ªå‹•å°å‘é¦–é ï¼Œä¸” Header é¡¯ç¤ºã€ŒğŸ‘¤ æ¸¬è©¦ä½¿ç”¨è€…ã€

### 3. æ¸¬è©¦ç™»å‡ºåŠŸèƒ½

1. é»æ“Š Header çš„ã€ŒğŸ‘¤ æ¸¬è©¦ä½¿ç”¨è€…ã€æŒ‰éˆ•
2. åœ¨ä¸‹æ‹‰é¸å–®ä¸­é»æ“Šã€Œç™»å‡ºã€
3. æ‡‰è©²æœƒå°å‘é¦–é ï¼Œä¸” Header é¡¯ç¤ºã€Œç™»å…¥ã€æŒ‰éˆ•

### 4. æ¸¬è©¦ç™»å…¥åŠŸèƒ½

1. é»æ“Š Header çš„ã€Œç™»å…¥ã€æŒ‰éˆ•
2. å¡«å¯«ç™»å…¥è¡¨å–®ï¼š
   - Emailï¼štest@example.com
   - å¯†ç¢¼ï¼š123456
3. é»æ“Šã€Œç™»å…¥ã€æŒ‰éˆ•
4. æ‡‰è©²æœƒè‡ªå‹•å°å‘é¦–é ï¼Œä¸” Header é¡¯ç¤ºä½¿ç”¨è€…åç¨±

### 5. æ¸¬è©¦æœƒå“¡ä¸­å¿ƒ

1. ç¢ºä¿å·²ç™»å…¥
2. é»æ“Š Header çš„ä½¿ç”¨è€…åç¨±
3. é»æ“Šã€Œæœƒå“¡ä¸­å¿ƒã€
4. æ‡‰è©²æœƒé¡¯ç¤ºå€‹äººè³‡æ–™ï¼ˆå§“åã€Emailã€è¨»å†Šæ—¥æœŸç­‰ï¼‰

### 6. æ¸¬è©¦èªè­‰ä¿è­·

1. ç™»å‡ºç‹€æ…‹ä¸‹ï¼Œç›´æ¥è¨ªå• `http://localhost:3000/account`
2. æ‡‰è©²æœƒè‡ªå‹•å°å‘ç™»å…¥é é¢

---

## ğŸ” API æ¸¬è©¦ï¼ˆä½¿ç”¨ curl æˆ– Postmanï¼‰

### è¨»å†Š API

```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test2@example.com",
    "password": "123456",
    "name": "æ¸¬è©¦ä½¿ç”¨è€…2",
    "phone": "0987654321"
  }'
```

### ç™»å…¥ API

```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test2@example.com",
    "password": "123456"
  }' \
  -c cookies.txt
```

### å–å¾—ç•¶å‰ä½¿ç”¨è€… API

```bash
curl http://localhost:3000/api/auth/me \
  -b cookies.txt
```

### ç™»å‡º API

```bash
curl -X POST http://localhost:3000/api/auth/logout \
  -b cookies.txt
```

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```
server/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ register.post.ts    # è¨»å†Š API
â”‚       â”œâ”€â”€ login.post.ts       # ç™»å…¥ API
â”‚       â”œâ”€â”€ logout.post.ts      # ç™»å‡º API
â”‚       â””â”€â”€ me.get.ts          # å–å¾—ç•¶å‰ä½¿ç”¨è€… API
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.ts              # Drizzle schema
â”‚   â””â”€â”€ db.ts                  # è³‡æ–™åº«é€£ç·š
â””â”€â”€ utils/
    â”œâ”€â”€ jwt.ts                 # JWT å·¥å…·å‡½æ•¸
    â””â”€â”€ password.ts            # å¯†ç¢¼åŠ å¯†å·¥å…·

pages/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ register.vue           # è¨»å†Šé é¢
â”‚   â””â”€â”€ login.vue              # ç™»å…¥é é¢
â””â”€â”€ account/
    â””â”€â”€ index.vue              # æœƒå“¡ä¸­å¿ƒ

stores/
â””â”€â”€ auth.ts                    # Auth Store (Pinia)

components/
â””â”€â”€ AppHeader.vue              # Headerï¼ˆå·²æ•´åˆä½¿ç”¨è€…é¸å–®ï¼‰
```

---

## ğŸ” å®‰å…¨æ€§ç‰¹é»

- âœ… å¯†ç¢¼ä½¿ç”¨ bcrypt åŠ å¯†ï¼ˆSalt rounds: 10ï¼‰
- âœ… JWT Token æœ‰æ•ˆæœŸç‚º 7 å¤©
- âœ… ä½¿ç”¨ HTTP-only Cookie å„²å­˜ tokenï¼ˆé˜²æ­¢ XSS æ”»æ“Šï¼‰
- âœ… å¾Œç«¯é©—è­‰æ‰€æœ‰è¼¸å…¥ï¼ˆEmail æ ¼å¼ã€å¯†ç¢¼é•·åº¦ç­‰ï¼‰
- âœ… å‰ç«¯è¡¨å–®é©—è­‰
- âœ… å¯†ç¢¼ç¢ºèªæ©Ÿåˆ¶

---

## ğŸš€ ä¸‹ä¸€éšæ®µè¨ˆç•«

### éšæ®µäºŒï¼šè¨‚å–®ç³»çµ±
- [ ] å»ºç«‹ Orders è³‡æ–™è¡¨
- [ ] å»ºç«‹ OrderItems è³‡æ–™è¡¨
- [ ] çµå¸³é é¢ä¸²æ¥è¨‚å–® API
- [ ] è¨‚å–®åˆ—è¡¨é é¢
- [ ] è¨‚å–®è©³æƒ…é é¢

### éšæ®µä¸‰ï¼šé‡‘æµä¸²æ¥
- [ ] é¸æ“‡é‡‘æµæœå‹™å•†ï¼ˆç¶ ç•Œ ECPayã€è—æ–° NewebPayï¼‰
- [ ] ä¸²æ¥ä¿¡ç”¨å¡æ”¯ä»˜
- [ ] ä¸²æ¥ ATM è½‰å¸³
- [ ] ä¸²æ¥è¶…å•†ä»£ç¢¼
- [ ] ä»˜æ¬¾ç‹€æ…‹å›èª¿è™•ç†

### éšæ®µå››ï¼šå¾Œå°ç®¡ç†
- [ ] å¾Œå°ç™»å…¥ï¼ˆç®¡ç†å“¡æ¬Šé™ï¼‰
- [ ] å•†å“ç®¡ç† CRUD
- [ ] è¨‚å–®ç®¡ç†
- [ ] æœƒå“¡ç®¡ç†
- [ ] æ•¸æ“šçµ±è¨ˆå„€è¡¨æ¿

---

## ğŸ’¡ æ¸¬è©¦æç¤º

1. **æ¸…é™¤è³‡æ–™åº«**ï¼šåˆªé™¤ `dev.db` æª”æ¡ˆï¼Œç„¶å¾ŒåŸ·è¡Œ `bunx drizzle-kit migrate`
2. **æ¸…é™¤ Cookie**ï¼šåœ¨ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ä¸­æ¸…é™¤ `auth_token` cookie
3. **æŸ¥çœ‹è³‡æ–™åº«**ï¼šä½¿ç”¨ SQLite å®¢æˆ¶ç«¯æŸ¥çœ‹ `dev.db` æª”æ¡ˆ
4. **æª¢è¦– JWT Token**ï¼šåœ¨ [jwt.io](https://jwt.io) è²¼ä¸Š token æŸ¥çœ‹å…§å®¹

---

**æ¸¬è©¦å®Œæˆæ—¥æœŸ**: 2025-11-18
**é–‹ç™¼è€…**: Claude AI
